on:
  workflow_dispatch:

name: Test
jobs:
  test:
    name: Test
    runs-on: ubuntu-latest
    steps:
      - name: get python version
        id: python
        run: |
          echo "version=$(python3 -V | awk '{split($2,a,"."); print "{\"major\":"a[1]",\"minor\":"a[2]",\"patch\":"a[3]"}"}')" >> $GITHUB_OUTPUT

      - name: debug python version
        run: |
          echo "JSON: ${{ steps.python.outputs.version }}"

      - name: fix python3.12 missing distutils
        env:
          MAJOR: ${{ fromJSON(steps.python.outputs.version).major }}
          MINOR: ${{ fromJSON(steps.python.outputs.version).minor }}
          PATCH: ${{ fromJSON(steps.python.outputs.version).patch }}
        run: python3 -m pip install packaging setuptools
        if: ${{ fromJSON($MAJOR) >= 3 && fromJSON($MINOR) >= 12 }}

